<html>

<head>
  <title>MUD</title>
  <style>
  body {
    background-color: black;
  }
  
  table {
    border: 0px;
  }
  
  tr {
    border: 0px;
  }
  
  td {
    font-family: Courier;
    border: solid white 1px;
  }
  
  pre {
    font-family: Courier;
  }
  
  #log {
    background-color: black;
    color: green;
    width: 800px;
    height: 400px;
    font-family: Courier;
    overflow-y: scroll;
  }
  
  input[type=text] {
    background-color: black;
    color: green;
    width: 800px;
    font-family: Courier;
  }
  
  .green {
    color: green;
  }
  
  .red {
    color: red;
  }
  
  .aqua {
    color: aqua;
  }
  
  .cyan {
    color: cyan;
  }
  
  .darkCyan {
    color: darkcyan;
  }
  
  .gray {
    color: gray;
  }
  
  .silver {
    color: silver;
  }
  
  .white {
    color: white;
  }
  
  .purple {
    color: purple;
  }
  
  .teal {
    color: teal;
  }
  
  .mediumOrchid {
    color: mediumOrchid;
  }
  </style>
  <script src="http://localhost:3000/socket.io/socket.io.js"></script>
  <script>
  var commandHistory = [];
  var historyIndex = -1;

  var socket = io("http://localhost:3000");

  socket.on('output', function(data) {
    var ta = document.getElementById('log');

    var newHTML = data.message.replace(/\n/g, '<br />\n');
    ta.innerHTML = ta.innerHTML + newHTML + '<br />';
    ta.scrollTop = ta.scrollHeight;
  });

  function sendData(e) {

    var tb = document.getElementById("textData");

    // esc
    if (e.keyCode === 27) {
      tb.value = '';
      historyIndex = -1;
    }

    // up arrow
    if (e.keyCode == 38) {
      historyIndex++;
      if (historyIndex > commandHistory.length - 1) historyIndex = commandHistory.length - 1;
      tb.value = commandHistory[historyIndex];
    }

    // down arrow
    if (e.keyCode == 40) {

      // if you push the down arrow when history index is already 0, just blank the field and return.
      historyIndex--;
      if (historyIndex > -1) {
        tb.value = commandHistory[historyIndex];
      } else {
        tb.value = '';
      }
      if (historyIndex < -1) historyIndex = -1;
    }

    // enter press
    if (e.keyCode == 13) {
      socket.emit('command', {
        value: tb.value
      });
      commandHistory.unshift(tb.value); // save command
      commandHistory.splice(25); // only save 25 commands
      historyIndex = -1;
      tb.value = '';
      return false;
    }
  }
  </script>
</head>

<body>
  <!--
  <table>
    <tr>
      <td>something</td>
      <td>something</td>
      <td>something</td>
      </tr>
    <tr>
      <td>something</td>
      <td>something</td>
      <td>something</td>
      </tr>
    <tr>
      <td>something</td>
      <td>something</td>
      <td>something</td>
      </tr>
      </table>
      -->
  <div id="log">
    <!-- <textarea id="log" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" readonly="true"></textarea> -->
  </div>
  <div>
    <input id="textData" onkeypress="return sendData(event)" type="text" />
  </div>
</body>

</html>
